query stories(
    $filters: StoryFiltersInput
    $pagination: PaginationArg
    $sort: [String]
    $publicationState: PublicationState
    $locale: I18NLocaleCode
) {
    stories(
        filters: $filters
        pagination: $pagination
        sort: $sort
        publicationState: $publicationState
        locale: $locale
    ) {
        data {
            ...StoryFragment
        }
        meta {
            ...ResponseCollectionMetaFragment
        }
    }
}


query story($id: ID, $locale: I18NLocaleCode) {
    story(id: $id, locale: $locale) {
        data {
            ...StoryFragment
        }
    }
}

query storyByLocale(
    $id: ID   
) {
    story(
        id: $id
    ) {
        data {
            ...LocalizedStoryFragment
        }
    }
}


query storyMetaByLocale(
    $id: ID
) {
    story(
        id: $id
    ) {
        data {
            ...LocalizedStoryMetaFragment
        }
    }
}

query storiesWithoutRelations(
    $filters: StoryFiltersInput
    $pagination: PaginationArg
    $sort: [String]
    $publicationState: PublicationState
    $locale: I18NLocaleCode
) {
    stories(
        filters: $filters
        pagination: $pagination
        sort: $sort
        publicationState: $publicationState
        locale: $locale
    ) {
        data {
            ...StoryWithoutRelationsFragment
        }
        meta {
            ...ResponseCollectionMetaFragment
        }
    }
}


query storyWithoutRelations($id: ID, $locale: I18NLocaleCode) {
    story(id: $id, locale: $locale) {
        data {
            ...StoryWithoutRelationsFragment
        }
    }
}

# "$type" must be ENUM_TRIPLYRECORD_TYPE
query storiesLinkedToTriplyRecord($recordId: String!, $type: String!) {
    stories(filters: { triplyRecords: { recordId: { eq: $recordId }, type: { eq: $type } } }) {
        data {
            id
            attributes {
                slug
                title
            }
        }
    }
}

query storiesLinkedToTheme($id: ID!, $locale: I18NLocaleCode) {
    story(id: $id, locale: $locale) {
        data {
            id
            attributes {
                themes {
                    data {
                        id
                        attributes {
                            stories {
                                data {
                                    id
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

query storiesByIds($storiesIds: [ID]!) {
    stories(filters: { id: { in: $storiesIds } }) {
        data {
            attributes {
                title
                slug
                locale
                components {
                    ... on ComponentModulesImage {
                        ...ComponentModulesImageFragment
                    }
                }
                localizations{
                    data {
                        ...StoryWithoutRelationsFragment
                    }
                }
            }
        }
    }
}

query storyTriplyRelations($id: ID!) {
    story(id: $id) {
        data {
            id
            attributes {
                triplyRecords {
                    data {
                        ...BaseTriplyRecordFragment
                    }
                }
            }
        }
    }
}

query storiesTotal {
    stories {
        meta {
            pagination {
                total
            }
        }
    }
}

fragment StoryWithoutRelationsFragment on StoryEntity {
    id
    attributes {
        title
        slug
        description
        shortDescription
        createdAt
        updatedAt
        publishedAt
        locale
        author {
            data {
                attributes {
                    firstName
                }
            }
        }
    }
}

fragment NestedStoryFragment on StoryEntity {
    id
    attributes {
        title
        slug
        description
        locale
        components {
           __typename
            ... on ComponentModulesPullquote {
                ...ComponentModulesPullquoteFragment
            }
            ... on ComponentModulesGridModule {
                ...ComponentModulesGridModuleFragment
            }
            ... on ComponentModulesTextModule {
                ...ComponentModulesTextModuleFragment
            }
            ... on ComponentModulesSubtitle {
                ...ComponentModulesSubtitleFragment
            }
            ... on ComponentModulesTitleModule {
                ...ComponentModulesTitleModuleFragment
            }
            ... on ComponentModulesImageCarousel {
                ...ComponentModulesImageCarouselFragment
            }
            ... on ComponentModulesImage {
                ...ComponentModulesImageFragment
            }
            ... on ComponentModulesTableModule {
                ...ComponentModulesTableModuleFragment
            }
            ... on ComponentModulesButtonsModule {
                ...ComponentModulesButtonsModuleFragment
            }
            ... on Error {
                ...ErrorFragment
            }
        }
    }
}

fragment LocalizedStoryFragment on StoryEntity {
    id
    attributes {
        title
        slug
        description
        locale
        components {
           __typename
            ... on ComponentModulesPullquote {
                ...ComponentModulesPullquoteFragment
            }
            ... on ComponentModulesGridModule {
                ...ComponentModulesGridModuleFragment
            }
            ... on ComponentModulesTextModule {
                ...ComponentModulesTextModuleFragment
            }
            ... on ComponentModulesSubtitle {
                ...ComponentModulesSubtitleFragment
            }
            ... on ComponentModulesTitleModule {
                ...ComponentModulesTitleModuleFragment
            }
            ... on ComponentModulesImageCarousel {
                ...ComponentModulesImageCarouselFragment
            }
            ... on ComponentModulesImage {
                ...ComponentModulesImageFragment
            }
            ... on ComponentModulesTableModule {
                ...ComponentModulesTableModuleFragment
            }
            ... on ComponentModulesButtonsModule {
                ...ComponentModulesButtonsModuleFragment
            }
            ... on Error {
                ...ErrorFragment
            }
        }
        localizations {
            data {
                ...NestedStoryFragment
            }
        }
    }
}

fragment StoryFragment on StoryEntity {
    id
    attributes {
        title
        slug
        components {
            __typename
            ... on ComponentModulesPullquote {
                ...ComponentModulesPullquoteFragment
            }
            ... on ComponentModulesGridModule {
                ...ComponentModulesGridModuleFragment
            }
            ... on ComponentModulesTextModule {
                ...ComponentModulesTextModuleFragment
            }
            ... on ComponentModulesSubtitle {
                ...ComponentModulesSubtitleFragment
            }
            ... on ComponentModulesTitleModule {
                ...ComponentModulesTitleModuleFragment
            }
            ... on ComponentModulesImageCarousel {
                ...ComponentModulesImageCarouselFragment
            }
            ... on ComponentModulesImage {
                ...ComponentModulesImageFragment
            }
            ... on ComponentModulesTableModule {
                ...ComponentModulesTableModuleFragment
            }
            ... on ComponentModulesButtonsModule {
                ...ComponentModulesButtonsModuleFragment
            }
            ... on Error {
                ...ErrorFragment
            }
        }
        author {
            data {
                id
            }
        }
        description
        timeframe {
            id
            yearStart
            yearEnd
        }
        locations {
            data {
                id
            }
        }
        publicationDate {
            id
            date
            displayType
        }
        shortDescription
        triplyRecords {
            data {
                ...BaseTriplyRecordFragment
            }
        }
        createdAt
        updatedAt
        publishedAt
        localizations {
            data {
                id
            }
        }
        locale
        storyLinks {
            ...ComponentModulesButtonsModuleFragment
        }
    }
}

fragment StoryMetaFragment on StoryEntity {
    id
    attributes {
        title
        slug
        shortDescription
        createdAt
        updatedAt
        publishedAt
        locale
        author {
            data {
                id
            }
        }
        timeframe {
            id
            yearStart
            yearEnd
        }
        locations {
            data {
                id
                attributes {
                    city
                }
            }
        }
        themes {
            data {
                id
                attributes {
                    name
                }
            }
        }
        publicationDate {
            id
            date
            displayType
        }
        triplyRecords {
            data {
                ...BaseTriplyRecordFragment
            }
        }
        storyLinks {
            ...ComponentModulesButtonsModuleFragment
        }
    }
}

fragment LocalizedStoryMetaFragment on StoryEntity {
    id
    attributes {
        title
        slug
        shortDescription
        description
        createdAt
        updatedAt
        publishedAt
        locale
        author {
            data {
                id
            }
        }
        timeframe {
            id
            yearStart
            yearEnd
        }
        locations {
            data {
                id
                attributes {
                    city
                }
            }
        }
        themes {
            data {
                id
                attributes {
                    name
                }
            }
        }
        publicationDate {
            id
            date
            displayType
        }
        triplyRecords {
            data {
                ...BaseTriplyRecordFragment
            }
        }
        localizations {
            data {
                ...StoryMetaFragment
            }
        }
        storyLinks {
            ...ComponentModulesButtonsModuleFragment
        }
    }
}
